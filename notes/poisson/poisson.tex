\documentclass{article}
\usepackage{amsmath,amssymb,graphicx,subfig,mathrsfs,amsthm}
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
\newtheorem{theorem}{Theorem}
\usepackage[OT2,T1]{fontenc}
\DeclareSymbolFont{cyrletters}{OT2}{wncyr}{m}{n}
\DeclareMathSymbol{\Sha}{\mathalpha}{cyrletters}{"58}
\newcommand{\sinc}{\textrm{sinc}} 
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\begin{document}
\title{The Poisson summation formula, the sampling theorem, and Dirac combs}
\author{Jordan Bell\\ \texttt{jordan.bell@gmail.com}\\Department of Mathematics, University of Toronto}
\date{\today}

\maketitle

\section{Poisson summation formula}
Let $\mathcal{S}(\mathbb{R})$ be the set of all infinitely differentiable functions $f$ on $\mathbb{R}$ such that
for all nonnegative integers $m$ and $n$,
\[
\nu_{m,n}(f)=\sup_{x \in \mathbb{R}} |x|^m |f^{(n)}(x)|
\]
is finite. For each $m$ and $n$, $\nu_{m,n}$ is a seminorm. This is a countable collection of seminorms, and $\mathcal{S}(\mathbb{R})$ is a 
Fr\'echet space. (One has to prove for $v_k \in \mathcal{S}(\mathbb{R})$ that if for each fixed $m,n$ the sequence $\nu_{m,n}(f_k)$
is a Cauchy sequence (of numbers), then there exists some $v \in \mathcal{S}(\mathbb{R})$ such that for each
$m,n$ we have $\nu_{m,n}(f-f_k) \to 0$.) I mention that $\mathcal{S}(\mathbb{R})$ is a Fr\'echet space merely because it is satisfying
to give a structure to a set with which we are working: if I call this set Schwartz space I would like to know what type of space it is, in the same sense that an $L^p$ space is a Banach space.

For $f \in \mathcal{S}(\mathbb{R})$, define
\[
\hat{f}(\xi)=\int_{\mathbb{R}} e^{-i \xi x} f(x) dx,
\]
and then
\[
f(x)=\frac{1}{2\pi} \int_{\mathbb{R}} e^{i x \xi}\hat{f}(\xi) d\xi.
\]

Let $\mathbb{T}=\mathbb{R}/2\pi \mathbb{Z}$. For $\phi \in C^\infty(\mathbb{T})$, define
\[
\hat{\phi}(n)=\frac{1}{2\pi}\int_0^{2\pi} e^{-int} \phi(t)dt,
\]
and then
\[
\phi(t)=\sum_{n \in \mathbb{Z}} \hat{\phi}(n) e^{int}.
\]

For $f \in \mathcal{S}(\mathbb{R})$ and $\lambda \neq 0$, define $\phi_\lambda:\mathbb{T} \to \mathbb{C}$ by
\[
\phi_\lambda(t)=2\pi \sum_{j \in \mathbb{Z}} f_\lambda(t+2\pi j),
\]
where $f_\lambda(x)=\lambda f(\lambda x)$. We have $\phi_\lambda \in C^\infty(\mathbb{T})$. 

For $n \in \mathbb{Z}$,
\begin{eqnarray*}
\widehat{\phi_\lambda}(n)&=&\frac{1}{2\pi}\int_0^{2\pi} e^{-int} \cdot 2\pi \sum_{j \in \mathbb{Z}} f_\lambda(t+2\pi j) dt\\
&=&\sum_{j \in \mathbb{Z}} \int_0^{2\pi} e^{-int} f_\lambda(t+2\pi j) dt\\
&=&\int_{\mathbb{R}} e^{-inx} f_\lambda(x) dx\\
&=&\widehat{f_\lambda}(n).
\end{eqnarray*}
One checks that 
 $\widehat{f_\lambda}(\xi)= \hat{f}\left(\frac{\xi}{\lambda}\right)$, so $\widehat{\phi_\lambda}(n)=\hat{f}\left( \frac{n}{\lambda} \right)$.
Thus for $t \in \mathbb{T}$,
\[
\phi_\lambda(t)=\sum_{n \in \mathbb{Z}} \hat{f}\left( \frac{n}{\lambda} \right) e^{int}.
\]
Therefore, if $f \in \mathcal{S}(\mathbb{R})$ then for each $t \in \mathbb{T}$,
\[
2\pi \sum_{j \in \mathbb{Z}} f_\lambda(t+2\pi j)=\sum_{n \in \mathbb{Z}} \hat{f}\left( \frac{n}{\lambda} \right) e^{int},
\]
where $f_\lambda(x)=\lambda f(\lambda x)$.
This is the {\em Poisson summation formula}. 

\section{Nyquist-Shannon sampling theorem}
Let $f \in \mathcal{S}(\mathbb{R})$. Suppose that there is some $L$ such that $f(x)=0$ if $|x| > L$ (namely, $f$ is {\em spacelimited}).
We can in fact choose $\lambda$ so that all terms with $j \neq 0$ on the left-hand side of the Poisson summation formula are zero,
which then expresses $f_\lambda(t)$ in terms of discrete samples of the Fourier transform of $f$.

If there is an $L$ such that $\hat{f}(\xi)=0$ for $|\xi|>L$, we say that $f$ is {\em bandlimited}. (For $f:\mathbb{T} \to \mathbb{C}$ this correspond to
$f$ being a trigonometric polynomial.)
We can prove a dual Poisson formula and apply it to bandlimited functions, but instead I am going to give a direct argument following
Charles L. Epstein, {\em Introduction to the Mathematics of Medical Imaging}, second ed., which is a good reference for sampling.

Suppose that $f \in \mathcal{S}(\mathbb{R})$ and $f(\xi)=0$ for $|\xi|>L$.\footnote{In fact, if $f, \hat{f} \in L^1(\mathbb{R})$ and $f$ is bandlimited then it follows that
$f$ is infinitely differentiable, although it does not follow that $f$ is Schwartz.} 
For $-\pi \leq \xi \leq \pi$, define $F:\mathbb{T} \to \mathbb{C}$ by\footnote{We are defining a periodic function $F$ from a function $\hat{f}$ that is not
periodic, but rather which becomes $0$ after $L$.} 
\[
F(\xi)=\hat{f}\left(\frac{\xi L}{\pi} \right).
\]
For $n \in \mathbb{Z}$,
\begin{eqnarray*}
\widehat{F}(n)&=&\frac{1}{2\pi} \int_{-\pi}^{\pi} e^{-in \xi} F(\xi) d\xi\\
&=&\frac{1}{2\pi} \int_{-\pi}^{\pi} e^{-in\xi} \hat{f}\left(\frac{\xi L}{\pi} \right) d\xi\\
&=&\frac{1}{2L} \int_{-L}^L e^{-in \frac{\pi t}{L}} \hat{f}(t) dt.
\end{eqnarray*}
On the other hand, for $x \in \mathbb{R}$, using the fact that $f$ is bandlimited,
\[
f(x)=\frac{1}{2\pi} \int_{\mathbb{R}} e^{ix\xi} \hat{f}(\xi) d\xi=\frac{1}{2\pi} \int_{-L}^L e^{ix\xi} \hat{f}(\xi) d\xi.
\]
Therefore for $n \in \mathbb{Z}$,
\[
\widehat{F}(n)=\frac{\pi}{L} f\left(\frac{-n\pi}{L} \right).
\]

As $F \in C^\infty(\mathbb{T})$, for $t \in \mathbb{T}$ we have
\[
F(t)=\sum_{n \in \mathbb{Z}} \widehat{F}(n) e^{int}=\sum_{n \in \mathbb{Z}}\frac{\pi}{L} f\left(\frac{-n\pi}{L} \right) e^{int}.
\]
Hence for $-L \leq \xi \leq L$,
\[
\hat{f}(\xi)=F\left(\frac{\pi \xi}{L} \right)=\sum_{n \in \mathbb{Z}}\frac{\pi}{L} f\left(\frac{-n\pi}{L} \right) e^{\frac{in \pi \xi}{L}}.
\]

For $0 \leq \eta<L$, let $\phi:\mathbb{R} \to \mathbb{R}$ satisfy
\[
\hat{\phi}(\xi)=\begin{cases}
1&|\xi| \leq L-\eta\\
0&|\xi|>L.
\end{cases}
\]
For instance, for $\eta=0$ let $\hat{\phi}$ be the characteristic function on $[-L,L]$. But if $\eta>0$ we can choose $\hat{\eta}$ to be smooth rather than a 
characteristic function. If $\hat{f}(\xi)=0$ for $|\xi|>L-\eta$ (rather than just for $|\xi|>L$), then $\hat{f}=\hat{f}\hat{\phi}$, because $\phi$ is equal to $1$ on
the support of $\hat{f}$. Then for $x \in \mathbb{R}$,
\begin{eqnarray*}
f(x)&=&\frac{1}{2\pi} \int_{\mathbb{R}} e^{ix\xi}\hat{f}(xi)\hat{\phi}(\xi) d\xi\\
&=&\frac{1}{2\pi} \int_{\mathbb{R}} e^{ix \xi} \sum_{n \in \mathbb{Z}}\frac{\pi}{L} f\left(\frac{-n\pi}{L} \right) e^{\frac{in \pi \xi}{L}} 
\hat{\phi}(\xi) d\xi\\
&=&\frac{1}{2L} \sum_{n \in \mathbb{Z}} f\left(\frac{-n\pi}{L} \right) \int_{\mathbb{R}} e^{ix\xi+ \frac{in\pi \xi}{L}} \hat{\phi}(\xi) d\xi\\
&=&\frac{1}{2L}  \sum_{n \in \mathbb{Z}} f\left(\frac{-n\pi}{L} \right) \cdot 2\pi \cdot \phi\left(x+\frac{n\pi}{L} \right)\\
&=&\frac{\pi}{L} \sum_{n \in \mathbb{Z}} f\left(\frac{-n\pi}{L} \right)\phi\left(x+\frac{n\pi}{L} \right).
\end{eqnarray*}
$\hat{\phi}$ can be chosen so that $\phi\left(x+\frac{n\pi}{L} \right)$ quickly goes to $0$ as $n \to \infty$. This means that fewer terms of
the above series need to be calculated to get a good approximation of $f(x)$. For $\hat{\phi}$ the characteristic function on $[-L,L]$,
we have
\[
\phi(x)=\frac{1}{2\pi} \int_{-L}^L e^{ix\xi} d\xi=\frac{\sin(xL)}{\pi x}=\frac{L}{\pi} \sinc(xL),
\]
where $\sinc(x)=\frac{\sin x}{x}$. Then we obtain, for $x \in \mathbb{R}$,
\[
f(x)= \sum_{n \in \mathbb{Z}} f\left(\frac{-n\pi}{L} \right) \sinc\left( x+\frac{n\pi}{L} \right),
\]
or
\[
f(x)= \sum_{n \in \mathbb{Z}} f\left(\frac{n\pi}{L} \right) \sinc\left( x-\frac{n\pi}{L} \right).
\]
Thus if $f$ is bandlimited, we can sample $f$ at a sequence of points and using these values reconstruct $f(x)$ for any $x \in \mathbb{R}$.
This fact is the {\em Nyquist-Shannon sampling theorem}, and the actual formula above is the {\em Whittaker-Shannon interpolation formula}.

A pleasant exposition of sampling is given in {\em Sampling: What Nyquist DidnÕt Say, and What to Do About It}, by Tim Wescott, 2010. 

\section{Dirac combs, pulse trains}
Define a tempered distribution $\Sha$ on $\mathbb{R}$ by
\[
\Sha(t)=\sum_{n \in \mathbb{Z}} \delta(t-n).
\]
This is called a {\em Dirac comb} or {\em pulse train}. If $f \in \mathcal{S}(\mathbb{R})$,
\[
\Sha f=\sum_{n \in \mathbb{Z}} f(n).
\]
The convolution of $f$ and $\Sha$ is the function
\[
(\Sha * f)(t)=\sum_{n \in \mathbb{Z}} f(t-n).
\]

Define
\[
\Sha_T(t)=\frac{1}{T}\Sha\left( \frac{t}{T} \right).
\]
Because $\delta(t/a)=|a|\delta(t)$ (the {\em scaling property} of the Dirac delta distribution; we have an absolute value sign
because if $a$ is negative then doing a change of variables in the definition of $\delta(t/a)$ we get two negative signs),
if $T>0$ then
\[
\Sha_T(t)=\sum_{n \in \mathbb{Z}} \frac{1}{T}\cdot \delta\left(\frac{t}{T}-n\right)
=\sum_{n \in \mathbb{Z}} \delta(t-nT),
\]
and we have
\[
\Sha_T f = \sum_{n \in \mathbb{Z}} f(nT)
\]
and 
\[
(\Sha_T * f)(t)=\sum_{n \in \mathbb{Z}} f(t-nT).
\]

$\Sha_T(t+T)=\Sha_T(t)$, so $\Sha_T$ is a periodic distribution on $\mathbb{R}$.  It follows that
 $\Sha_T$ is a distribution on $\mathbb{T}$. Folland talks about
 periodic distributions around p. 298 of his {\em Real Analysis}, second ed. 

Let $\gamma \in C^\infty_c(\mathbb{R})$ such that $\int_{\mathbb{R}} \gamma(x) dx=\frac{1}{2\pi}$,
and let $\omega=\gamma * \chi_{[0,2\pi)}$. 
If we have a $2\pi$-periodic distribution $F$ on $\mathbb{R}$ and $\psi \in C^\infty(\mathbb{T})$, 
 we define $F\psi$ to be $F(\omega\psi)$ ($\psi$ is viewed
 in this instance as a $2\pi$-periodic function on $\mathbb{R}$).
For $\psi \in C^\infty(\mathbb{T})$ we have, viewing $\psi$ as a $2\pi$-periodic function on $\mathbb{R}$ (thus
$\psi(2n\pi)=\psi(0)$),
\begin{eqnarray*}
\Sha_{2\pi}(\omega \psi)&=&\sum_{n \in \mathbb{Z}} \delta(t-2n\pi)(\omega \psi)\\
&=&\sum_{n \in \mathbb{Z}}  \omega(2n\pi)  \psi(2n\pi)\\
&=& \psi(0) \sum_{n \in \mathbb{Z}}  \int_{\mathbb{R}} \gamma(x)  \chi_{[0,2\pi)} (2n\pi - x) dx\\
&=&\psi(0) \int_{\mathbb{R}} \gamma(x) \sum_{n \in \mathbb{Z}}  \chi_{[0,2\pi)} (2n\pi - x) dx\\
&=&  \psi(0) \int_{\mathbb{R}} \gamma(x)\\
&=&  \frac{\psi(0)}{2\pi}.
\end{eqnarray*}
Thus as a distribution on $\mathbb{T}$, for $\psi \in C^\infty(\mathbb{T})$ we have $\Sha_{2\pi} \psi=\frac{\psi(0)}{2\pi}$.
For $n \in \mathbb{Z}$, $\widehat{\Sha_{2\pi}}(n)=\Sha_{2\pi} e^{-int}=\frac{1}{2\pi}$. Thus the Fourier series of
$\Sha_{2\pi}$ is
\[
\frac{1}{2\pi} \sum_{n \in \mathbb{Z}} e^{int}.
\]

\end{document}